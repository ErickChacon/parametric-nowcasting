---
title: "SARI: Model fitting"
prerequisites:
    - data/processed/sari_41002_20090614_20091122.rds
targets:
    - data/modelled/sari_41002_20090614_20091122_mcmc.rds
---



<div id="load-packages-scripts-and-data" class="section level2">
<h2>Load packages, scripts and data</h2>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>#&gt; 
#&gt; Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>#&gt; The following objects are masked from &#39;package:stats&#39;:
#&gt; 
#&gt;     filter, lag</code></pre>
<pre><code>#&gt; The following objects are masked from &#39;package:base&#39;:
#&gt; 
#&gt;     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(tidyr)
library(ggplot2)
library(cmdstanr)</code></pre>
<pre><code>#&gt; CmdStan path set to: /usr/share/cmdstan/cmdstan-2.36.0</code></pre>
<pre><code>#&gt; This is cmdstanr version 0.9.0</code></pre>
<pre><code>#&gt; - CmdStanR documentation and vignettes: mc-stan.org/cmdstanr</code></pre>
<pre><code>#&gt; - CmdStan path: /usr/share/cmdstan/cmdstan-2.36.0</code></pre>
<pre><code>#&gt; - CmdStan version: 2.36.0</code></pre>
<pre class="r"><code>path_proj &lt;- here::here()
path_src &lt;- file.path(path_proj, &quot;src&quot;)
path_models &lt;- file.path(path_src, &quot;models&quot;)
path_data &lt;- file.path(path_proj, &quot;data&quot;)
path_processed &lt;- file.path(path_data, &quot;processed&quot;)
path_modelled &lt;- file.path(path_data, &quot;modelled&quot;)
path_samples_sari &lt;- file.path(path_data, &quot;draws&quot;, &quot;sari&quot;)

source(file.path(path_src, &quot;20-processing.R&quot;))
source(file.path(path_src, &quot;30-eda.R&quot;))
source(file.path(path_src, &quot;50-modelling.R&quot;))

sari &lt;- readRDS(file.path(path_processed, &quot;sari_41002_20090614_20091122.rds&quot;))
range(sari$date)</code></pre>
<pre><code>#&gt; [1] &quot;2009-06-14&quot; &quot;2009-11-22&quot;</code></pre>
</div>
<div id="load-and-compile-models" class="section level2">
<h2>Load and compile models</h2>
<pre class="r"><code>model_names &lt;- c(&quot;nonparam&quot;, &quot;exp&quot;, &quot;exp_rw1&quot;, &quot;exp_ou&quot;)
models &lt;- file.path(path_models, paste0(model_names, &quot;.stan&quot;)) |&gt;
    lapply(cmdstan_model) |&gt;
    setNames(model_names)</code></pre>
</div>
<div id="fit-models" class="section level2">
<h2>Fit models</h2>
<p>Evaluate the priors for the cumulative reporting probability curves.</p>
<pre class="r"><code>hypers &lt;- hypers_q(phi_ref = 0.2, D_ref = 26, type = &quot;exponential&quot;, alpha_phi = 1.4, sd_log_b = 0.5, delay_seq = 0:26)</code></pre>
<p><img src="/parametric-nowcasting/60-model/22-sari-fit-model_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hypers</code></pre>
<pre><code>#&gt; $alpha_phi
#&gt; [1] 1.4
#&gt; 
#&gt; $beta_phi
#&gt; [1] 4.6
#&gt; 
#&gt; $mean_log_b
#&gt; [1] -2.238315
#&gt; 
#&gt; $sd_log_b
#&gt; [1] 0.5
#&gt; 
#&gt; $mean_logit_phi
#&gt; [1] -1.474825
#&gt; 
#&gt; $sd_logit_phi
#&gt; [1] 1.126088</code></pre>
<p>Obtain mcmc samples for selected models assuming different ending times.</p>
<pre class="r"><code>D &lt;- 26
end_dates &lt;- seq(as.Date(&quot;2009-08-02&quot;), as.Date(&quot;2009-11-22&quot;), by = &quot;4 week&quot;)
samples_list &lt;- nowcast_sample_dates(sari, models, hypers, end_dates, D,
    iter_sampling = 1000, iter_warmup = 500, chains = 1, refresh = 200, thin = 1,
    output_dir = path_samples_sari)</code></pre>
<pre><code>#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.3 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.1 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.8 seconds.</code></pre>
<pre><code>#&gt; Warning: 4 of 1000 (0.0%) transitions ended with a divergence.
#&gt; See https://mc-stan.org/misc/warnings for details.</code></pre>
<pre><code>#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.0 seconds.</code></pre>
<pre><code>#&gt; Warning: 58 of 1000 (6.0%) transitions ended with a divergence.
#&gt; See https://mc-stan.org/misc/warnings for details.</code></pre>
<pre><code>#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.7 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25416beddd.stan&#39;, line 35, column 6 to column 46)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.2 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.8 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 45, column 2 to column 43)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.0 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.0 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.1 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 44, column 4 to column 47)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.8 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.9 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.2 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25416beddd.stan&#39;, line 35, column 6 to column 46)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.2 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 44, column 4 to column 47)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.1 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.2 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.5 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup) 
#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 0.2 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-25210c1d5c.stan&#39;, line 51, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.6 seconds.
#&gt; Running MCMC with 1 chain...
#&gt; 
#&gt; Chain 1 Iteration:    1 / 1500 [  0%]  (Warmup)</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 45, column 2 to column 43)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
<pre><code>#&gt; Chain 1 Exception: poisson_lpmf: Rate parameter is -nan, but must be nonnegative! (in &#39;/tmp/RtmpHQ1XaZ/model-2545d3120c.stan&#39;, line 57, column 6 to column 49)</code></pre>
<pre><code>#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
<pre><code>#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
<pre><code>#&gt; Chain 1</code></pre>
<pre><code>#&gt; Chain 1 Iteration:  200 / 1500 [ 13%]  (Warmup) 
#&gt; Chain 1 Iteration:  400 / 1500 [ 26%]  (Warmup) 
#&gt; Chain 1 Iteration:  501 / 1500 [ 33%]  (Sampling) 
#&gt; Chain 1 Iteration:  700 / 1500 [ 46%]  (Sampling) 
#&gt; Chain 1 Iteration:  900 / 1500 [ 60%]  (Sampling) 
#&gt; Chain 1 Iteration: 1100 / 1500 [ 73%]  (Sampling) 
#&gt; Chain 1 Iteration: 1300 / 1500 [ 86%]  (Sampling) 
#&gt; Chain 1 Iteration: 1500 / 1500 [100%]  (Sampling) 
#&gt; Chain 1 finished in 1.7 seconds.</code></pre>
<pre class="r"><code>samples_list</code></pre>
<pre><code>#&gt; $`2009-08-02`
#&gt; $`2009-08-02`$nonparam
#&gt;   variable     mean   median      sd     mad      q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__       3594.68  3594.95    4.41    4.32 3587.20  3601.35 1.00      359      605
#&gt;  lambda[1]    11.91    11.35    3.71    3.43    6.91    19.22 1.01      199      542
#&gt;  lambda[2]    28.06    26.78    7.85    7.13   17.63    41.95 1.02      158      345
#&gt;  lambda[3]    83.11    79.76   22.47   19.54   51.64   124.22 1.01      144      332
#&gt;  lambda[4]    88.97    84.65   24.96   22.58   55.44   135.17 1.01      152      358
#&gt;  lambda[5]    73.80    70.52   21.96   20.86   44.19   113.85 1.01      165      386
#&gt;  lambda[6]   276.49   266.61   77.11   71.46  167.83   419.74 1.01      133      331
#&gt;  lambda[7]  2246.02  2136.02  650.19  582.19 1356.71  3405.12 1.01      144      372
#&gt;  lambda[8] 13891.18 13185.90 4409.27 3889.08 7964.87 22028.25 1.01      151      447
#&gt;  p[1]          0.02     0.02    0.01    0.01    0.01     0.03 1.01      147      437
#&gt; 
#&gt;  # showing 10 of 71 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-02`$exp
#&gt;   variable    mean  median      sd     mad      q5     q95 rhat ess_bulk ess_tail
#&gt;  lp__      3687.85 3688.20    2.25    2.20 3683.90 3690.77 1.01      387      444
#&gt;  lambda[1]    4.66    4.56    1.17    1.11    2.96    6.79 1.00      364      413
#&gt;  lambda[2]   11.03   10.73    2.33    2.06    7.89   15.12 1.00      255      197
#&gt;  lambda[3]   32.26   31.30    6.01    5.25   24.14   42.84 1.00      203      195
#&gt;  lambda[4]   34.79   33.43    7.19    6.22   25.40   47.77 1.00      238      170
#&gt;  lambda[5]   30.00   28.51    7.72    6.74   20.46   42.44 1.00      201      193
#&gt;  lambda[6]  118.19  112.04   28.65   23.81   83.58  171.27 1.00      187      175
#&gt;  lambda[7]  918.12  871.77  227.38  191.68  646.06 1325.21 1.00      161      134
#&gt;  lambda[8] 5528.77 5313.30 1504.22 1352.98 3608.35 8365.59 1.00      217      206
#&gt;  b            0.40    0.39    0.11    0.11    0.23    0.58 1.00      160      145
#&gt; 
#&gt;  # showing 10 of 46 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-02`$exp_rw1
#&gt;   variable    mean  median      sd     mad      q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__      3716.00 3716.20    7.03    7.03 3704.17  3727.30 1.00      103      190
#&gt;  lambda[1]    5.99    5.55    2.30    1.70    3.40     9.77 1.00      393      371
#&gt;  lambda[2]   14.13   13.23    5.31    3.40    8.49    22.38 1.00      317      234
#&gt;  lambda[3]   42.85   39.87   17.21   10.34   27.36    65.29 1.00      251      288
#&gt;  lambda[4]   30.09   27.81   11.47    7.67   18.52    48.54 1.00      391      374
#&gt;  lambda[5]   42.22   38.10   18.77   12.55   22.89    72.64 1.00      239      350
#&gt;  lambda[6]  195.43  178.37   87.25   57.47  106.09   332.84 1.00      213      277
#&gt;  lambda[7] 1493.05 1391.59  711.94  532.22  682.30  2606.81 1.01      215      287
#&gt;  lambda[8] 3765.04 1562.20 7456.89 1608.45  327.31 13381.82 1.01      391      546
#&gt;  log_b[1]    -1.62   -1.61    0.44    0.37   -2.31    -0.97 1.00      309      282
#&gt; 
#&gt;  # showing 10 of 267 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-02`$exp_ou
#&gt;   variable    mean  median      sd    mad      q5     q95 rhat ess_bulk ess_tail
#&gt;  lp__      3715.38 3715.70    7.56   7.64 3702.51 3727.27 1.00       85      204
#&gt;  lambda[1]    5.79    5.49    2.08   1.66    3.21    9.03 1.00      323      444
#&gt;  lambda[2]   14.12   13.47    5.13   3.59    8.70   21.15 1.00      310      541
#&gt;  lambda[3]   41.86   39.75   12.40  10.40   26.57   64.69 1.00      282      457
#&gt;  lambda[4]   29.16   26.21   11.50   7.09   17.68   49.00 1.00      202      268
#&gt;  lambda[5]   40.01   37.51   14.53  13.89   22.07   66.22 1.01      211      370
#&gt;  lambda[6]  259.06  218.39  148.13  78.92  123.56  532.25 1.01       55      134
#&gt;  lambda[7] 1383.29 1333.38  622.95 599.39  535.75 2508.79 1.03       87      127
#&gt;  lambda[8] 1742.29  957.74 2197.27 866.96  298.49 5589.71 1.01      236      539
#&gt;  log_b[1]    -1.52   -1.53    0.40   0.35   -2.18   -0.87 1.00      216      332
#&gt; 
#&gt;  # showing 10 of 271 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; 
#&gt; $`2009-08-30`
#&gt; $`2009-08-30`$nonparam
#&gt;   variable     mean   median     sd    mad       q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__      59984.49 59984.70   4.80   4.45 59975.80 59992.10 1.00      360      577
#&gt;  lambda[1]    12.38    11.96   2.85   2.66     8.65    17.44 1.00      162      254
#&gt;  lambda[2]    29.13    28.25   6.14   5.23    21.02    40.43 1.00      107      190
#&gt;  lambda[3]    81.90    79.76  16.47  14.89    60.31   110.25 1.01      100      153
#&gt;  lambda[4]    67.68    65.66  14.35  12.88    48.84    93.59 1.00      101      170
#&gt;  lambda[5]   111.46   107.97  23.25  19.20    81.23   152.38 1.01       96      161
#&gt;  lambda[6]   486.17   470.00  98.40  82.14   358.72   666.21 1.01       96      171
#&gt;  lambda[7]  1847.14  1776.99 377.76 318.43  1369.56  2539.73 1.01       91      185
#&gt;  lambda[8]  3548.33  3426.76 726.14 605.66  2637.46  4819.23 1.01       91      175
#&gt;  lambda[9]  3420.09  3308.46 700.62 588.64  2514.74  4668.09 1.01       91      160
#&gt; 
#&gt;  # showing 10 of 79 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-30`$exp
#&gt;   variable     mean   median     sd   mad       q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__      60070.28 60070.60   2.56  2.22 60065.40 60073.90 1.00      410      393
#&gt;  lambda[1]     6.22     6.17   0.93  0.91     4.79     7.77 1.01      499      415
#&gt;  lambda[2]    14.32    14.31   1.45  1.52    11.97    16.69 1.00      450      533
#&gt;  lambda[3]    39.24    39.08   2.88  2.84    34.72    44.03 1.00      362      612
#&gt;  lambda[4]    31.76    31.70   2.71  2.85    27.57    36.34 1.00      346      655
#&gt;  lambda[5]    51.22    51.08   4.02  3.79    44.93    58.17 1.00      333      498
#&gt;  lambda[6]   217.25   216.30  13.40 11.88   197.14   240.85 1.00      225      316
#&gt;  lambda[7]   800.62   795.98  48.10 43.76   729.47   887.68 1.00      182      280
#&gt;  lambda[8]  1548.73  1536.65  96.58 94.07  1412.49  1720.76 1.00      168      227
#&gt;  lambda[9]  1509.90  1500.09 102.13 91.60  1363.62  1702.11 1.00      173      219
#&gt; 
#&gt;  # showing 10 of 54 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-30`$exp_rw1
#&gt;   variable     mean   median     sd    mad       q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__      60195.95 60196.50   4.83   4.74 60187.79 60203.10 1.00      361      486
#&gt;  lambda[1]    11.82     9.99   6.96   4.08     5.56    22.52 1.00      660      699
#&gt;  lambda[2]    29.92    24.95  17.54   9.04    15.27    61.94 1.00      509      418
#&gt;  lambda[3]    76.13    65.35  39.91  21.82    42.46   148.22 1.01      435      517
#&gt;  lambda[4]    72.76    53.49  61.11  28.02    28.23   180.75 1.01      496      565
#&gt;  lambda[5]   139.35   120.27  68.47  44.04    71.94   259.14 1.01      693      613
#&gt;  lambda[6]   418.54   391.04 136.37  91.41   280.08   621.11 1.00      613      392
#&gt;  lambda[7]   578.54   577.15  21.96  21.41   545.09   616.31 1.01      855      651
#&gt;  lambda[8]  1312.00  1284.22 147.01 125.62  1123.74  1585.74 1.00      549      558
#&gt;  lambda[9]  1079.22  1069.10  98.86  89.61   945.39  1257.17 1.00      538      580
#&gt; 
#&gt;  # showing 10 of 399 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-08-30`$exp_ou
#&gt;   variable     mean   median     sd    mad       q5      q95 rhat ess_bulk ess_tail
#&gt;  lp__      60192.87 60193.50   4.95   4.89 60183.90 60200.30 1.01      364      515
#&gt;  lambda[1]     9.80     8.45   5.04   2.84     5.30    19.05 1.00      796      591
#&gt;  lambda[2]    25.83    23.04  11.17   7.71    14.20    47.03 1.00      621      671
#&gt;  lambda[3]    63.52    56.42  26.28  16.46    39.72   109.48 1.00      775      548
#&gt;  lambda[4]    55.53    43.06  41.57  18.29    24.94   128.45 1.00      505      560
#&gt;  lambda[5]   132.33   115.43  66.67  44.53    67.69   249.07 1.00      694      635
#&gt;  lambda[6]   448.56   409.01 151.59 109.74   290.50   723.36 1.00      554      541
#&gt;  lambda[7]   575.88   574.52  21.22  22.12   542.89   613.19 1.00     1032      626
#&gt;  lambda[8]  1345.11  1305.64 165.23 136.73  1152.07  1670.27 1.00      591      563
#&gt;  lambda[9]  1108.22  1088.70 128.97 107.51   947.95  1359.31 1.01      799      443
#&gt; 
#&gt;  # showing 10 of 403 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; 
#&gt; $`2009-09-27`
#&gt; $`2009-09-27`$nonparam
#&gt;   variable      mean    median     sd    mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      169957.84 169958.00   4.94   4.45 169949.00 169965.00 1.01      289      491
#&gt;  lambda[1]     10.89     10.69   1.71   1.67      8.38     13.88 1.00      160      311
#&gt;  lambda[2]     24.09     23.62   3.57   3.05     19.14     30.63 1.00      133      241
#&gt;  lambda[3]     65.89     64.72   9.05   8.29     53.57     83.58 1.00      116      195
#&gt;  lambda[4]     49.72     48.70   7.22   6.88     39.80     62.89 1.00      116      199
#&gt;  lambda[5]     92.24     90.02  13.21  11.56     74.33    117.90 1.00      112      194
#&gt;  lambda[6]    367.90    360.70  49.76  43.98    299.74    460.96 1.00      101      160
#&gt;  lambda[7]   1189.27   1164.27 161.15 136.43    974.45   1500.59 1.00      100      154
#&gt;  lambda[8]   2271.48   2224.30 307.66 256.96   1853.50   2864.98 1.00       99      134
#&gt;  lambda[9]   2221.25   2173.98 302.45 261.08   1819.26   2797.44 1.00       99      138
#&gt; 
#&gt;  # showing 10 of 87 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-09-27`$exp
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      170041.48 170042.00  3.03  2.97 170036.00 170046.00 1.00      390      533
#&gt;  lambda[1]      6.19      6.18  0.70  0.69      5.13      7.38 1.01      909      583
#&gt;  lambda[2]     13.57     13.55  1.04  1.01     11.99     15.35 1.00     1139      621
#&gt;  lambda[3]     36.27     36.25  1.81  1.80     33.35     39.13 1.00      848      555
#&gt;  lambda[4]     26.73     26.72  1.61  1.59     24.06     29.36 1.00      942      682
#&gt;  lambda[5]     49.04     49.02  2.38  2.45     45.30     53.04 1.00     1133      835
#&gt;  lambda[6]    192.31    192.36  5.25  5.73    183.73    200.87 1.00     1011      642
#&gt;  lambda[7]    614.21    614.09 10.63 11.49    597.18    631.74 1.00      457      511
#&gt;  lambda[8]   1166.97   1166.78 18.35 18.61   1137.43   1195.97 1.00      342      550
#&gt;  lambda[9]   1140.01   1139.87 20.07 19.61   1107.69   1174.21 1.00      351      498
#&gt; 
#&gt;  # showing 10 of 62 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-09-27`$exp_rw1
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      170257.23 170257.00  5.54  5.93 170248.00 170266.00 1.00      336      579
#&gt;  lambda[1]      9.95      9.23  3.44  2.16      6.61     15.06 1.00      784      597
#&gt;  lambda[2]     20.90     19.75  5.13  3.44     15.42     29.99 1.00      752      640
#&gt;  lambda[3]     50.72     49.31  7.71  6.71     40.92     65.57 1.00      560      469
#&gt;  lambda[4]     34.02     32.53  6.46  5.35     26.41     47.39 1.00      531      548
#&gt;  lambda[5]     76.56     74.55 12.15 10.40     60.80     97.95 1.00      815      415
#&gt;  lambda[6]    244.34    243.08 13.64 13.38    223.71    268.90 1.00     1287      688
#&gt;  lambda[7]    578.35    578.48 11.26 11.63    559.90    596.40 1.00     1084      851
#&gt;  lambda[8]   1139.51   1140.11 24.43 25.60   1099.88   1181.03 1.00     1178      600
#&gt;  lambda[9]   1120.99   1119.55 28.79 27.21   1076.31   1169.04 1.00     1262      819
#&gt; 
#&gt;  # showing 10 of 531 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-09-27`$exp_ou
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      170252.26 170253.00  5.76  5.93 170243.00 170261.00 1.01      253      436
#&gt;  lambda[1]      9.04      8.51  2.53  1.72      6.26     13.66 1.00      409      361
#&gt;  lambda[2]     20.26     19.38  4.48  3.52     15.11     28.89 1.00      489      497
#&gt;  lambda[3]     50.22     48.85  7.85  6.73     40.54     65.79 1.00      666      306
#&gt;  lambda[4]     33.96     31.81  8.47  5.54     25.65     49.36 1.00      380      284
#&gt;  lambda[5]     78.43     76.44 12.02  9.64     61.65    101.78 1.00      871      662
#&gt;  lambda[6]    247.71    246.27 15.77 15.31    224.76    274.88 1.00      871      713
#&gt;  lambda[7]    576.57    576.57 11.16 11.35    558.08    594.47 1.00      972      757
#&gt;  lambda[8]   1142.32   1141.27 27.53 28.50   1100.76   1187.99 1.00      612      272
#&gt;  lambda[9]   1124.29   1122.75 29.77 29.67   1078.53   1175.24 1.00      750      637
#&gt; 
#&gt;  # showing 10 of 535 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; 
#&gt; $`2009-10-25`
#&gt; $`2009-10-25`$nonparam
#&gt;   variable      mean    median     sd    mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      309652.39 309653.00   5.09   4.45 309644.00 309660.00 1.00      343      549
#&gt;  lambda[1]      9.65      9.56   1.29   1.26      7.69     12.01 1.01      193      331
#&gt;  lambda[2]     21.01     20.71   2.41   2.36     17.48     25.49 1.01      161      310
#&gt;  lambda[3]     56.01     55.36   5.92   5.82     47.74     67.25 1.01      127      205
#&gt;  lambda[4]     40.55     40.11   4.60   4.67     33.92     48.72 1.01       84      244
#&gt;  lambda[5]     79.82     78.64   8.50   8.38     68.21     94.94 1.01      101      214
#&gt;  lambda[6]    304.73    300.25  30.80  30.67    261.44    357.59 1.02       68      220
#&gt;  lambda[7]    937.23    924.51  94.55  94.92    804.06   1108.98 1.01       73      197
#&gt;  lambda[8]   1797.58   1768.54 181.59 180.46   1545.47   2136.65 1.01       75      216
#&gt;  lambda[9]   1779.57   1753.41 178.70 179.28   1537.57   2110.42 1.01       75      207
#&gt; 
#&gt;  # showing 10 of 95 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-10-25`$exp
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      309740.60 309741.00  3.40  2.97 309735.00 309745.00 1.00      440      585
#&gt;  lambda[1]      6.60      6.56  0.63  0.63      5.60      7.68 1.00     1408      761
#&gt;  lambda[2]     14.26     14.22  0.92  0.91     12.76     15.84 1.00     1275      671
#&gt;  lambda[3]     37.52     37.49  1.59  1.62     34.94     39.99 1.00      955      628
#&gt;  lambda[4]     26.90     26.84  1.33  1.30     24.69     29.19 1.00     1192      786
#&gt;  lambda[5]     52.33     52.29  1.98  2.08     49.27     55.65 1.00     1185      624
#&gt;  lambda[6]    198.81    198.67  3.95  4.25    192.64    205.49 1.00      992      820
#&gt;  lambda[7]    606.94    607.10  7.67  7.31    594.55    619.17 1.00     1016      733
#&gt;  lambda[8]   1160.07   1160.12 12.43 11.92   1139.41   1180.58 1.00      762      677
#&gt;  lambda[9]   1145.05   1144.88 13.04 11.87   1123.46   1166.15 1.00      889      637
#&gt; 
#&gt;  # showing 10 of 70 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-10-25`$exp_rw1
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      309973.50 309974.00  6.01  5.93 309963.00 309983.00 1.00      257      556
#&gt;  lambda[1]      8.84      8.60  1.56  1.35      6.85     11.66 1.00      884      404
#&gt;  lambda[2]     18.42     18.14  2.27  2.14     15.17     22.54 1.00      698      723
#&gt;  lambda[3]     45.34     44.87  3.91  3.52     39.70     52.23 1.00     1458      642
#&gt;  lambda[4]     30.08     29.65  3.13  2.70     25.77     35.90 1.00      940      761
#&gt;  lambda[5]     67.45     67.09  5.26  5.00     59.50     77.09 1.00      782      767
#&gt;  lambda[6]    225.01    224.72  6.98  6.79    214.39    237.19 1.00     1739      902
#&gt;  lambda[7]    582.50    582.40  8.24  8.23    568.34    595.67 1.00     1556      831
#&gt;  lambda[8]   1139.71   1139.79 15.32 14.89   1114.11   1165.07 1.00     2280      599
#&gt;  lambda[9]   1135.74   1135.64 15.32 15.23   1110.15   1159.37 1.00     1845      952
#&gt; 
#&gt;  # showing 10 of 663 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-10-25`$exp_ou
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      309972.42 309973.00  6.45  5.93 309961.00 309982.00 1.00      331      531
#&gt;  lambda[1]      8.22      8.02  1.26  1.12      6.48     10.52 1.00      499      574
#&gt;  lambda[2]     17.88     17.63  2.18  1.99     14.81     22.01 1.00      648      646
#&gt;  lambda[3]     44.67     44.24  3.67  3.45     39.45     51.49 1.00      646      448
#&gt;  lambda[4]     29.35     28.95  3.03  2.55     25.49     34.75 1.00      469      186
#&gt;  lambda[5]     67.99     67.35  5.94  5.60     59.45     78.53 1.01      458      392
#&gt;  lambda[6]    225.92    225.41  7.23  7.26    215.14    237.87 1.01      852      782
#&gt;  lambda[7]    581.68    581.64  8.17  8.52    568.69    595.33 1.00      957      816
#&gt;  lambda[8]   1141.22   1140.93 15.64 15.39   1116.83   1168.21 1.01     1452      809
#&gt;  lambda[9]   1135.78   1135.53 16.96 17.43   1109.08   1164.57 1.00     1181      817
#&gt; 
#&gt;  # showing 10 of 667 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; 
#&gt; $`2009-11-22`
#&gt; $`2009-11-22`$nonparam
#&gt;   variable      mean    median     sd    mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      470185.31 470186.00   5.24   4.45 470176.00 470193.00 1.01      340      580
#&gt;  lambda[1]      8.82      8.76   0.94   0.92      7.43     10.51 1.01      132      444
#&gt;  lambda[2]     19.51     19.36   1.63   1.59     17.10     22.46 1.00      105      243
#&gt;  lambda[3]     50.95     50.67   3.78   3.70     45.20     57.70 1.01       71      200
#&gt;  lambda[4]     35.64     35.41   2.80   2.84     31.46     40.55 1.01       86      198
#&gt;  lambda[5]     73.46     72.95   5.42   5.08     65.21     83.31 1.01       66      172
#&gt;  lambda[6]    271.81    269.73  18.84  19.40    243.48    305.59 1.01       60      165
#&gt;  lambda[7]    819.02    813.83  55.86  57.41    736.58    918.71 1.01       58      123
#&gt;  lambda[8]   1589.66   1579.73 107.82 110.25   1428.01   1782.34 1.01       58      161
#&gt;  lambda[9]   1567.63   1556.09 106.86 108.12   1409.70   1762.05 1.01       58      132
#&gt; 
#&gt;  # showing 10 of 103 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-11-22`$exp
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      470270.16 470270.00  3.59  2.97 470264.00 470275.00 1.00      491      585
#&gt;  lambda[1]      6.95      6.94  0.58  0.62      6.00      7.90 1.00     1180      722
#&gt;  lambda[2]     15.19     15.19  0.87  0.91     13.77     16.61 1.00     1881      786
#&gt;  lambda[3]     39.36     39.35  1.44  1.45     36.98     41.68 1.00     1460      723
#&gt;  lambda[4]     27.37     27.31  1.23  1.29     25.38     29.50 1.00     1538      724
#&gt;  lambda[5]     55.85     55.88  1.87  1.94     52.83     58.88 1.00     1094      759
#&gt;  lambda[6]    205.72    205.72  3.43  3.66    200.24    211.17 1.00     1160      847
#&gt;  lambda[7]    616.80    616.71  6.82  6.93    606.09    627.97 1.00     1369      845
#&gt;  lambda[8]   1193.55   1193.50  9.82 10.16   1177.06   1210.15 1.00     1114      927
#&gt;  lambda[9]   1174.36   1174.59 11.23 10.67   1156.00   1193.18 1.00     1290      675
#&gt; 
#&gt;  # showing 10 of 78 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-11-22`$exp_rw1
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      470544.16 470544.00  6.67  5.93 470532.00 470555.00 1.00      323      468
#&gt;  lambda[1]      8.67      8.49  1.26  1.06      7.05     11.05 1.00     1005      745
#&gt;  lambda[2]     18.40     18.20  1.77  1.64     15.93     21.60 1.00      876      634
#&gt;  lambda[3]     45.05     44.86  2.79  2.70     40.81     50.01 1.00      879      641
#&gt;  lambda[4]     28.89     28.77  1.95  1.86     26.09     32.10 1.00      982      693
#&gt;  lambda[5]     66.18     65.95  3.65  3.67     60.54     72.37 1.00     1298      767
#&gt;  lambda[6]    220.50    220.35  5.10  5.21    212.26    229.25 1.00     1099      649
#&gt;  lambda[7]    588.84    588.77  6.49  7.11    578.43    598.75 1.00     1334      767
#&gt;  lambda[8]   1170.42   1170.34 12.15 12.28   1150.43   1190.72 1.00     1367      714
#&gt;  lambda[9]   1151.67   1151.64 12.85 13.40   1131.34   1173.09 1.00     1533      879
#&gt; 
#&gt;  # showing 10 of 795 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)
#&gt; 
#&gt; $`2009-11-22`$exp_ou
#&gt;   variable      mean    median    sd   mad        q5       q95 rhat ess_bulk ess_tail
#&gt;  lp__      470546.24 470546.00  6.84  7.41 470535.00 470557.00 1.00      355      400
#&gt;  lambda[1]      8.15      8.06  0.99  0.89      6.76      9.78 1.00     1111      679
#&gt;  lambda[2]     17.99     17.85  1.59  1.48     15.67     20.80 1.00      937      736
#&gt;  lambda[3]     44.62     44.42  2.57  2.37     40.83     49.16 1.00     1349      569
#&gt;  lambda[4]     28.54     28.38  1.95  1.81     25.61     31.96 1.00     1487      725
#&gt;  lambda[5]     66.58     66.21  3.83  3.59     60.86     73.27 1.00     1097      731
#&gt;  lambda[6]    221.12    220.94  5.32  5.28    212.59    229.76 1.00     1836      694
#&gt;  lambda[7]    588.72    588.73  6.68  6.66    578.00    599.63 1.00     1554      907
#&gt;  lambda[8]   1171.14   1170.37 12.25 12.41   1151.98   1192.15 1.00     1706      799
#&gt;  lambda[9]   1151.38   1151.60 12.27 11.95   1131.27   1171.80 1.00     1897      693
#&gt; 
#&gt;  # showing 10 of 799 rows (change via &#39;max_rows&#39; argument or &#39;cmdstanr_max_rows&#39; option)</code></pre>
</div>
<div id="save-mcmc-samples" class="section level2">
<h2>Save mcmc samples</h2>
<pre class="r"><code>saveRDS(samples_list, file.path(path_modelled, &quot;sari_41002_20090614_20091122_mcmc.rds&quot;))</code></pre>
</div>
<div id="time-to-execute-the-task" class="section level2">
<h2>Time to execute the task</h2>
<p>Only useful when executed with <code>Rscript</code>.</p>
<pre class="r"><code>proc.time()</code></pre>
<pre><code>#&gt;    user  system elapsed 
#&gt;  20.856   0.821  26.538</code></pre>
</div>
